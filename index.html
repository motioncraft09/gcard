<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Service Guarantee Card</title>
<style>
body{
    font-family: 'Arial', sans-serif;
    background: linear-gradient(to right, #00c6ff, #0072ff);
    color: #333;
    margin:0;
    padding:0;
    overflow-x: hidden;
}
.container{
    max-width: 700px;
    margin: 50px auto;
    background: #fff;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    animation: fadeIn 1s ease-in-out;
}
h1,h2{text-align:center;}
input, textarea, select, button{
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    border-radius: 8px;
    border: 1px solid #ccc;
    transition: all 0.3s ease;
}
input:focus, textarea:focus, select:focus{
    border-color:#0072ff;
    box-shadow: 0 0 8px rgba(0,114,255,0.3);
    outline:none;
}
button{
    background: #0072ff;
    color: #fff;
    font-weight: bold;
    border:none;
    cursor: pointer;
}
button:hover{
    background: #005bb5;
}
#result{
    background: #f1f1f1;
    padding:15px;
    margin-top:15px;
    border-radius:8px;
    display:none;
}
@keyframes fadeIn{
    0%{opacity:0; transform: translateY(-20px);}
    100%{opacity:1; transform: translateY(0);}
}
</style>
</head>
<body>

<div class="container" id="registrationDiv">
    <h1>গ্যারান্টি কার্ড রেজিস্ট্রেশন</h1>
    <form id="guaranteeForm">
        <h2>Seller Information</h2>
        <input type="text" name="sellerName" placeholder="Seller Name" required>
        <input type="email" name="sellerEmail" placeholder="Seller Email" required>

        <h2>Buyer Information</h2>
        <input type="text" name="buyerName" placeholder="Buyer Name" required>
        <input type="email" name="buyerEmail" placeholder="Buyer Email" required>

        <h2>Service Details</h2>
        <textarea name="serviceDescription" placeholder="Service Description" required></textarea>
        <input type="number" name="budget" placeholder="Budget (৳)" id="budget" required>
        <input type="number" name="guaranteePeriod" placeholder="Guarantee Period (days)" required>
        <textarea name="terms" placeholder="Terms" required></textarea>

        <h2>Payment Details</h2>
        <input type="text" name="txId" placeholder="Transaction ID" required>
        <input type="text" name="senderNumber" placeholder="Sender Number" required>
        <select name="paymentMethod" required>
            <option value="bKash">bKash</option>
            <option value="Nagad">Nagad</option>
            <option value="Rocket">Rocket</option>
        </select>

        <input type="hidden" name="fee" id="fee">
        <input type="hidden" name="total" id="total">
        <input type="hidden" name="certificateId" id="certificateId">
        <input type="hidden" name="type" value="Guarantee Card">

        <button type="submit">Register Guarantee Card</button>
    </form>
</div>

<div class="container" id="verifyDiv">
    <h1>গ্যারান্টি কার্ড ভেরিফাই</h1>
    <form id="verifyForm">
        <input type="text" id="searchCertificate" placeholder="Certificate ID" required>
        <button type="submit">Verify</button>
    </form>
    <div id="result"></div>
</div>

<script>
// Auto calculate 2% fee & generate certificate
const form = document.getElementById('guaranteeForm');
const budgetInput = document.getElementById('budget');
const feeInput = document.getElementById('fee');
const totalInput = document.getElementById('total');
const certificateInput = document.getElementById('certificateId');

function calculateFee(){
    const budget = parseFloat(budgetInput.value) || 0;
    const fee = budget*0.02;
    const total = budget+fee;
    feeInput.value = fee.toFixed(2);
    totalInput.value = total.toFixed(2);
}

function generateCertificate(){
    const id = 'GC-'+Math.floor(Math.random()*1000000);
    certificateInput.value = id;
}

budgetInput.addEventListener('input', calculateFee);
form.addEventListener('submit', (e)=>{
    generateCertificate();
    e.preventDefault();

    const formData = new FormData(form);
    fetch('submit.php',{method:'POST',body:formData})
    .then(res=>res.text())
    .then(data=>{
        alert('Registration successful! Certificate ID: '+certificateInput.value);
        form.reset();
    }).catch(err=>{
        alert('Error submitting form.');
    });
});

// Verify system (JSON)
const verifyForm = document.getElementById('verifyForm');
const resultDiv = document.getElementById('result');

verifyForm.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const id = document.getElementById('searchCertificate').value;
    const res = await fetch('data.json');
    const data = await res.json();

    const card = data.find(c => c.certificateId === id && c.status==='Paid');
    if(card){
        resultDiv.style.display='block';
        resultDiv.innerHTML = `
        <h2>Card Verified ✅</h2>
        <p><strong>Certificate ID:</strong> ${card.certificateId}</p>
        <p><strong>Seller:</strong> ${card.sellerName}</p>
        <p><strong>Buyer:</strong> ${card.buyerName}</p>
        <p><strong>Service:</strong> ${card.serviceDescription}</p>
        <p><strong>Total:</strong> ৳ ${card.total}</p>
        <p><strong>Verification Code:</strong> ${card.verificationCode}</p>
        <p><strong>Expiry Date:</strong> ${card.expiryDate}</p>
        `;
    }else{
        resultDiv.style.display='block';
        resultDiv.innerHTML='<p>Card not found or not paid yet ❌</p>';
    }
});
</script>

</body>
</html>
